<p>Some of the most exciting applications of large language models involve taking real-world action, such as booking flight tickets or finding and fixing software bugs. AI systems that carry out such tasks are called agents. They use LLMs in combination with other software to use tools such as web search and code terminals. </p><p>The North Star of this field is to build assistants like Siri or Alexa and get them to actually work &#8212; handle complex tasks, accurately interpret users&#8217; requests, and perform reliably. But this is far from a reality, and even the research direction is fairly new. To stimulate the development of agents and measure their effectiveness, researchers have created benchmark datasets. But as we&#8217;ve said before, <a href="https://www.cs.princeton.edu/~arvindn/talks/evaluating_llms_minefield/">LLM evaluation is a minefield</a>, and it turns out that agent evaluation has a bunch of additional pitfalls that affect today&#8217;s benchmarks and evaluation practices. This state of affairs encourages the development of agents that do well on benchmarks without being useful in practice.</p><p>We have released a new paper that identifies the challenges in evaluating agents and proposes ways to address them. <strong>Read the paper <a href="https://arxiv.org/abs/2407.01502">here</a>. </strong>The authors are Sayash Kapoor, <a href="https://citp.princeton.edu/citp-people/benedikt-strobl/">Benedikt Str&#246;bl</a>, <a href="https://www.zacharysiegel.org/">Zachary S. Siegel</a>, <a href="https://citp.princeton.edu/citp-people/nitya-nadgir/">Nitya Nadgir</a>, and Arvind Narayanan, all at Princeton University.&nbsp;</p><p>In this post, we offer thoughts on the definition of AI agents, why we are cautiously optimistic about the future of AI agent research, whether AI agents are more hype or substance, and give a brief overview of the paper.</p><h4><strong>What does the term agent mean? Is it just a buzzword?</strong></h4><p>The term agent has been used by AI researchers without a formal definition.<a class="footnote-anchor" href="https://www.aisnakeoil.com/feed#footnote-1" id="footnote-anchor-1" target="_self">1</a> This has led to its being hijacked as a marketing term, and has generated a bit of pushback against its use. But the term isn&#8217;t meaningless. Many researchers have tried to formalize the community's intuitive understanding of what constitutes an agent in the context of language-model-based systems [<a href="https://cdn.openai.com/papers/practices-for-governing-agentic-ai-systems.pdf">1</a>, <a href="https://dl.acm.org/doi/10.1145/3593013.3594033">2</a>, <a href="https://arxiv.org/abs/2404.16244">3</a>, <a href="https://lilianweng.github.io/posts/2023-06-23-agent/">4</a>, <a href="https://blog.langchain.dev/what-is-an-agent/">5</a>]. Rather than a binary, it can be seen as a spectrum, sometimes denoted by the term <a href="https://www.deeplearning.ai/the-batch/welcoming-diverse-approaches-keeps-machine-learning-strong/">'agentic'</a>.&nbsp;</p><p>The five recent definitions of AI agents cited above are all distinct but with strong similarities to each other. Rather than propose a new definition, we identified three clusters of properties that cause an AI system to be considered more agentic according to existing definitions:</p><p><strong>Environment and goals.</strong> The more complex the environment, the more AI systems operating in that environment are agentic. Complex environments are those that have a range of tasks and domains, multiple stakeholders, a long time horizon to take action, and unexpected changes. Further, systems that pursue complex goals without being instructed on how to pursue the goal are more agentic.</p><p><strong>User interface and supervision.</strong> AI systems that can be instructed in natural language and act autonomously on the user's behalf are more agentic. In particular, systems that require less user supervision are more agentic. For example, chatbots cannot take real-world action, but adding plugins to chatbots (such as Zapier for ChatGPT) allows them to take some actions on behalf of users.</p><p><strong>System design.</strong> Systems that use tools (like web search or code terminal) or planning (like reflecting on previous outputs or decomposing goals into subgoals) are more agentic. Systems whose control flow is driven by an LLM, rather than LLMs being invoked by a static program, are more agentic.</p><h4><strong>Do agents even work?</strong></h4><p>While some agents such as ChatGPT&#8217;s code interpreter / data analysis mode have been useful, more ambitious agent-based products so far have failed. The two main product launches based on AI agents have been the <a href="https://www.rabbit.tech/">Rabbit R1</a> and <a href="https://humane.com/">Humane AI pin</a>. These devices promised to eliminate or reduce phone dependence, but turned out to be too slow and unreliable. Devin, an &#8220;AI software engineer&#8221;, was announced with great hype 4 months ago, but has been panned in a <a href="https://www.youtube.com/watch?v=tNmgmwEtoWE">video review</a> and remains in waitlist-only mode. It is clear that if AI agents are to be useful in real-world products, they have a long way to go.</p><div class="captioned-image-container"><figure><a class="image-link image2 is-viewable-img" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F483f2069-4a32-41ad-8bb4-94b2fb7793fc_1310x664.png" target="_blank"><div class="image2-inset"><source type="image/webp" /><img alt="" class="sizing-normal" height="265.6" src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F483f2069-4a32-41ad-8bb4-94b2fb7793fc_1310x664.png" width="524" /><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg class="lucide lucide-refresh-cw" fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg class="lucide lucide-maximize2" fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption"><a href="https://x.com/SnazzyLabs/status/1783220942812111220">Source</a></figcaption></figure></div><p>So are AI agents all hype? It&#8217;s too early to tell. We think there are research challenges to be solved before we can expect agents such as the ones above to work well enough to be widely adopted. The only way to find out is through more research, so we do think research on AI agents is worthwhile.</p><p>One major research challenge is reliability &#8212; LLMs are <a href="https://x.com/random_walker/status/1778770599340290103">already capable enough</a> to do many tasks that people want an assistant to handle, but not reliable enough that they can be successful products. To appreciate why, think of a flight-booking agent that needs to make dozens of calls to LLMs. If each of those went wrong independently with a probability of, say, just 2%, the overall system would be so unreliable as to be completely useless (this partly explains some of the product failures we&#8217;ve seen). So research on improving reliability might have many new applications <em>even if</em> the underlying language models don&#8217;t improve. And if <a href="https://www.aisnakeoil.com/p/ai-scaling-myths">scaling runs out</a>, agents are the most natural direction for further progress in AI.</p><p>Right now, however, research is itself contributing to hype and overoptimism because evaluation practices are not rigorous enough, much like the early days of machine learning research before the common task method took hold. That brings us to our paper.</p><h4><strong>Contributions of the paper</strong></h4><p>What changes must the AI community implement to help stimulate the development of AI agents that are useful in the real world, and not just on benchmarks? This is the paper&#8217;s central question. We make five recommendations:</p><p>1.<strong> Implement cost-controlled evaluations.</strong> The language models underlying most AI agents are stochastic. This means simply calling the underlying model multiple times can increase accuracy. We show that such simple tricks can outperform complex agent architectures on the HumanEval benchmark, while costing much less. We argue that all agent evaluation must control for cost. (We originally published this finding <a href="https://www.aisnakeoil.com/p/ai-leaderboards-are-no-longer-useful">here</a>. In the two months since we published this post, Pareto curves and joint optimization of cost and accuracy have become <a href="https://x.com/lmsysorg/status/1807812671238258931">increasingly common</a> in <a href="https://www.together.ai/blog/together-moa">agent</a> <a href="https://x.com/corbtt/status/1803813970018791845">evaluations</a>.)</p><p>2. <strong>Jointly optimize accuracy and cost.</strong> Visualizing evaluation results as a Pareto curve of accuracy and inference cost opens up a new space of agent design: jointly optimizing the two metrics. We show how we can lower cost while maintaining accuracy on HotPotQA by implementing a modification to the DSPy framework.</p><p>3. <strong>Distinguish model and downstream benchmarking. </strong>Through a case study of NovelQA, we show how benchmarks meant for model evaluation can be misleading when used for downstream evaluation. We argue that downstream evaluation should account for dollar costs, rather than proxies for cost such as the number of model parameters.</p><p>4. <strong>Prevent shortcuts in agent benchmarks.</strong> We show that many types of overfitting to agent benchmarks are possible. We identify 4 levels of generality of agents and argue that different types of hold-out samples are needed based on the desired level of generality. Without proper hold-outs, agent developers can take shortcuts, even unintentionally. We illustrate this with a case study of the WebArena benchmark.</p><p>5. <strong>Improve the standardization and reproducibility of agent benchmarks.</strong> We found pervasive shortcomings in the reproducibility of WebArena and HumanEval evaluations. These errors inflate accuracy estimates and lead to overoptimism about agent capabilities.</p><h4><strong>Concluding thoughts: reasons for cautious optimism</strong></h4><p>AI agent benchmarking is new and best practices haven't yet been established, making it hard to distinguish genuine advances from hype. We think agents are sufficiently different from models that benchmarking practices need to be rethought. In our paper, we take the first steps toward a principled approach to agent benchmarking. We hope these steps will raise the rigor of AI agent evaluation and provide a firm foundation for progress.</p><p>A different strand of our research concerns the reproducibility crisis in ML-based research in <a href="https://www.aisnakeoil.com/p/scientists-should-use-ai-as-a-tool">scientific fields</a> such as medicine or social science. At some level, our current paper is similar. In ML-based science, our outlook is that things will get worse before they get better. But in AI agents research, we are cautiously optimistic that practices will change quickly. One reason is that there is a stronger culture of sharing code and data alongside published papers, so errors are easier to spot. (This culture shift came about due to concerted efforts in the <a href="https://jmlr.org/papers/v22/20-303.html">last five years</a>.) Another reason is that overoptimistic research quickly gets a reality check when products based on misleading evaluations end up flopping. This is going to be an interesting space to watch over the next few years, both in terms of research and product releases.</p><div class="footnote"><a class="footnote-number" contenteditable="false" href="https://www.aisnakeoil.com/feed#footnote-anchor-1" id="footnote-1" target="_self">1</a><div class="footnote-content"><p>In traditional AI, agents are defined entities that perceive and act upon their environment, but that definition is less useful in the LLM era &#8212; even a thermostat would qualify as an agent under that definition.</p><p></p></div></div>