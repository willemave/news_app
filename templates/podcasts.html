{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6">Podcasts</h1>
    
    <!-- Filter Form -->
    <div class="mb-6 p-4 bg-gray-100 rounded-lg">
        <form method="get" class="flex flex-wrap gap-4 items-end">
            <div>
                <label for="feed_name" class="block text-sm font-medium text-gray-700 mb-1">Feed</label>
                <select name="feed_name" id="feed_name" class="border border-gray-300 rounded-md px-3 py-2">
                    <option value="">All Feeds</option>
                    {% for feed in feed_names %}
                    <option value="{{ feed }}" {% if current_feed == feed %}selected{% endif %}>{{ feed }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div>
                <label for="status" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                <select name="status" id="status" class="border border-gray-300 rounded-md px-3 py-2">
                    <option value="">All Statuses</option>
                    <option value="new" {% if current_status == "new" %}selected{% endif %}>New</option>
                    <option value="downloaded" {% if current_status == "downloaded" %}selected{% endif %}>Downloaded</option>
                    <option value="transcribed" {% if current_status == "transcribed" %}selected{% endif %}>Transcribed</option>
                    <option value="summarized" {% if current_status == "summarized" %}selected{% endif %}>Summarized</option>
                    <option value="failed" {% if current_status == "failed" %}selected{% endif %}>Failed</option>
                </select>
            </div>
            
            <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                Filter
            </button>
            
            <a href="/podcasts" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                Clear
            </a>
        </form>
    </div>

    <!-- Podcasts List -->
    {% if podcasts %}
    <div class="grid gap-6">
        {% for podcast in podcasts %}
        <div class="bg-white shadow-md rounded-lg p-6 border border-gray-200">
            <div class="flex justify-between items-start mb-4">
                <div class="flex-1">
                    <h2 class="text-xl font-semibold mb-2">
                        <a href="/podcasts/detail/{{ podcast.id }}" class="text-blue-600 hover:text-blue-800">
                            {{ podcast.title }}
                        </a>
                    </h2>
                    <p class="text-gray-600 mb-2">
                        <strong>Feed:</strong> {{ podcast.podcast_feed_name }}
                    </p>
                    {% if podcast.publication_date %}
                    <p class="text-gray-500 text-sm mb-2">
                        <strong>Published:</strong> {{ podcast.publication_date.strftime('%Y-%m-%d %H:%M') }}
                    </p>
                    {% endif %}
                </div>
                
                <div class="ml-4">
                    {% if podcast.status.value == "new" %}
                    <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">New</span>
                    {% elif podcast.status.value == "downloaded" %}
                    <span class="inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Downloaded</span>
                    {% elif podcast.status.value == "transcribed" %}
                    <span class="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">Transcribed</span>
                    {% elif podcast.status.value == "summarized" %}
                    <span class="inline-block bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full">Summarized</span>
                    {% elif podcast.status.value == "failed" %}
                    <span class="inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">Failed</span>
                    {% endif %}
                </div>
            </div>
            
            {% if podcast.short_summary %}
            <div class="mb-4">
                <p class="text-gray-700">{{ podcast.short_summary }}</p>
            </div>
            {% endif %}
            
            <div class="flex justify-between items-center text-sm text-gray-500">
                <span>Added: {{ podcast.created_date.strftime('%Y-%m-%d %H:%M') }}</span>
                <a href="/podcasts/detail/{{ podcast.id }}" class="text-blue-600 hover:text-blue-800 font-medium">
                    View Details â†’
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-12">
        <p class="text-gray-500 text-lg">No podcasts found.</p>
        {% if current_status or current_feed %}
        <p class="text-gray-400 mt-2">Try adjusting your filters or <a href="/podcasts" class="text-blue-600 hover:text-blue-800">view all podcasts</a>.</p>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}